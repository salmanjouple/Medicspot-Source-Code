/* ----------------------------------------------------------------------------
 * Easy!Appointments - Open Source Web Scheduler
 *
 * @package     EasyAppointments
 * @author      A.Tselegidis <alextselegidis@gmail.com>
 * @copyright   Copyright (c) 2013 - 2016, Alex Tselegidis
 * @license     http://opensource.org/licenses/GPL-3.0 - GPLv3
 * @link        http://easyappointments.org
 * @since       v1.0.0
 * ---------------------------------------------------------------------------- */
window.GeneralFunctions=window.GeneralFunctions||{};(function(exports){'use strict';exports.EXCEPTIONS_TITLE=EALang.unexpected_issues;exports.EXCEPTIONS_MESSAGE=EALang.unexpected_issues_message;exports.WARNINGS_TITLE=EALang.unexpected_warnings;exports.WARNINGS_MESSAGE=EALang.unexpected_warnings_message;exports.displayMessageBox=function(title,message,messageButtons){if(title==undefined||title==''){title='<No Title Given>'}
    if(message==undefined||message==''){message='<No Message Given>'}
    if(messageButtons==undefined){messageButtons={};messageButtons[EALang.close]=function(){$('#message_box').dialog('close')}}
    $('#message_box').dialog('destroy');$('#message_box').remove();$('body').append('<div id="message_box" title="'+title+'">'+'<p>'+message+'</p>'+'</div>');$("#message_box").dialog({autoOpen:!1,modal:!0,resize:'auto',width:'auto',height:'auto',resizable:!1,buttons:messageButtons,closeOnEscape:!0});$('#message_box').dialog('open');$('.ui-dialog .ui-dialog-buttonset button').addClass('btn btn-default');$('#message_box .ui-dialog-titlebar-close').hide()};exports.centerElementOnPage=function(elementHandle){$(window).resize(function(){var elementLeft=($(window).width()-elementHandle.outerWidth())/2;var elementTop=($(window).height()-elementHandle.outerHeight())/2;elementTop=(elementTop>0)?elementTop:20;elementHandle.css({position:'absolute',left:elementLeft,top:elementTop})});$(window).resize()};exports.getUrlParameter=function(url,parameterName){var parsedUrl=url.substr(url.indexOf('?')).slice(1).split('&');for(var index in parsedUrl){var parsedValue=parsedUrl[index].split('=');if(parsedValue.length===1&&parsedValue[0]===parameterName){return''}
    if(parsedValue.length===2&&parsedValue[0]===parameterName){return decodeURIComponent(parsedValue[1])}}
    return''};exports.ISODateString=function(date){function pad(n){return n<10?'0'+n:n}
    return date.getUTCFullYear()+'-'+pad(date.getUTCMonth()+1)+'-'+pad(date.getUTCDate())+'T'+pad(date.getUTCHours())+':'+pad(date.getUTCMinutes())+':'+pad(date.getUTCSeconds())+'Z'};exports.clone=function(originalObject){if(null==originalObject||'object'!=typeof originalObject)
    return originalObject;if(originalObject instanceof Date){var copy=new Date();copy.setTime(originalObject.getTime());return copy}
    if(originalObject instanceof Array){var copy=[];for(var i=0,len=originalObject.length;i<len;i++){copy[i]=GeneralFunctions.clone(originalObject[i])}
        return copy}
    if(originalObject instanceof Object){var copy={};for(var attr in originalObject){if(originalObject.hasOwnProperty(attr))
        copy[attr]=GeneralFunctions.clone(originalObject[attr])}
        return copy}
    throw new Error('Unable to copy obj! Its type isn\'t supported.')};exports.validateEmail=function(email){var re=/^([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22))*\x40([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d))*$/;return re.test(email)};exports.exceptionsToHtml=function(exceptions){var html='<div class="accordion" id="error-accordion">'+'<div class="accordion-group">'+'<div class="accordion-heading">'+'<a class="accordion-toggle" data-toggle="collapse" '+'data-parent="#error-accordion" href="#error-technical">'+EALang.details+'</a>'+'</div>';$.each(exceptions,function(index,exception){html+='<div id="error-technical" class="accordion-body collapse">'+'<div class="accordion-inner">'+'<pre>'+exception.message+'</pre>'+'</div>'+'</div>'});html+='</div></div>';return html};exports.parseExceptions=function(exceptions){var parsedExceptions=new Array();$.each(exceptions,function(index,exception){parsedExceptions.push($.parseJSON(exception))});return parsedExceptions};exports.ucaseFirstLetter=function(str){return str.charAt(0).toUpperCase()+str.slice(1)};exports.handleAjaxExceptions=function(response){if(response.exceptions){response.exceptions=GeneralFunctions.parseExceptions(response.exceptions);GeneralFunctions.displayMessageBox(GeneralFunctions.EXCEPTIONS_TITLE,GeneralFunctions.EXCEPTIONS_MESSAGE);$('#message_box').append(GeneralFunctions.exceptionsToHtml(response.exceptions));return!1}
    if(response.warnings){response.warnings=GeneralFunctions.parseExceptions(response.warnings);GeneralFunctions.displayMessageBox(GeneralFunctions.WARNINGS_TITLE,GeneralFunctions.WARNINGS_MESSAGE);$('#message_box').append(GeneralFunctions.exceptionsToHtml(response.warnings))}
    return!0};exports.enableLanguageSelection=function($element){var html='<ul id="language-list">';$.each(availableLanguages,function(){html+='<li class="language" data-language="'+this+'">'+GeneralFunctions.ucaseFirstLetter(this)+'</li>'});html+='</ul>';$element.popover({placement:'top',title:'Select Language',content:html,html:!0,container:'body',trigger:'manual'});$element.click(function(){if($('#language-list').length===0){$(this).popover('show')}else{$(this).popover('hide')}
    $(this).toggleClass('active')});$(document).on('click','li.language',function(){var postUrl=GlobalVariables.baseUrl+'//backend_api/ajax_change_language';var postData={csrfToken:GlobalVariables.csrfToken,language:$(this).attr('data-language'),};$.post(postUrl,postData,function(response){if(!GeneralFunctions.handleAjaxExceptions(response)){return}
    document.location.reload(!0)},'json').fail(GeneralFunctions.ajaxFailureHandler)})};exports.ajaxFailureHandler=function(jqxhr,textStatus,errorThrown){var exceptions=[{message:'AJAX Error: '+errorThrown}];GeneralFunctions.displayMessageBox(GeneralFunctions.EXCEPTIONS_TITLE,GeneralFunctions.EXCEPTIONS_MESSAGE);$('#message_box').append(GeneralFunctions.exceptionsToHtml(exceptions))};exports.escapeHtml=function(str){return $('<div/>').text(str).html()};exports.formatDate=function(date,dateFormatSetting,addHours){var format,result;var hours=addHours?' HH:mm':'';switch(dateFormatSetting){case 'DMY':result=Date.parse(date).toString('dd/MM/yyyy'+hours);break;case 'MDY':result=Date.parse(date).toString('MM/dd/yyyy'+hours);break;case 'YMD':result=Date.parse(date).toString('yyyy/MM/dd'+hours);break;default:throw new Error('Invalid date format setting provided!',dateFormatSetting)}
    return result}})(window.GeneralFunctions)